<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Learning Game</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');

        body {
            font-family: 'Jua', sans-serif;
            background-color: #f0f8ff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            flex-direction: column;
            text-align: center;
            color: #333;
            padding: 20px;
            box-sizing: border-box;
            user-select: none;
        }

        .game-container {
            width: 90%;
            max-width: 600px;
            background-color: #fff;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            padding: 40px;
            box-sizing: border-box;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        #speaker {
            font-size: 6rem;
            cursor: pointer;
            color: #ff6347;
            transition: transform 0.2s, text-shadow 0.2s;
        }

        #speaker:active {
            transform: scale(0.9);
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
        }

        #question-counter {
            font-size: 2rem;
            font-weight: bold;
            color: #555;
            padding: 10px 20px;
            background-color: #e6e6fa;
            border-radius: 15px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .card-container {
            display: flex;
            justify-content: space-around;
            gap: 25px;
        }

        .card {
            flex: 1;
            aspect-ratio: 1 / 1;
            border-radius: 20px;
            background-color: #f8f8f8;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s, border 0.3s;
            cursor: pointer;
            overflow: hidden;
            border: 6px solid transparent;
            font-size: 10rem;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .card img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .result-message {
            margin-top: 30px;
            font-size: 2.5rem;
            font-weight: bold;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .correct {
            color: #28a745;
            animation: bounce 0.5s;
        }

        .incorrect {
            color: #dc3545;
            animation: shake 0.5s;
        }

        .correct-border {
            border-color: #28a745;
            box-shadow: 0 0 15px rgba(40, 167, 69, 0.6);
        }

        .incorrect-border {
            border-color: #dc3545;
            box-shadow: 0 0 15px rgba(220, 53, 69, 0.6);
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-10px); }
            40%, 80% { transform: translateX(10px); }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <div class="game-container">
        <div class="header">
            <span id="speaker" role="button" aria-label="스피커 아이콘">🔊</span>
            <span id="question-counter">1/10</span>
        </div>
        <div class="card-container">
            <div class="card" id="card1">
                <img src="" alt="그림 1">
            </div>
            <div class="card" id="card2">
                <img src="" alt="그림 2">
            </div>
        </div>
        <div id="result-message" class="result-message"></div>
        
    </div>

    <script>
        window.onload = function() {
            // 단어 데이터: 단어와 이미지 파일명을 포함
            const words = [
                { word: 'apple', image: 'apple.jpg' },
                { word: 'banana', image: 'banana.jpg' },
                { word: 'car', image: 'car.jpg' },
                { word: 'cat', image: 'cat.jpg' },
                { word: 'dog', image: 'dog.jpg' },
                { word: 'subway', image: 'subway.jpg' },
            ];
            
            // 퀴즈 문제로 사용될 단어 쌍
            const questionPairs = [
                ['apple', 'banana'],
                ['car', 'cat'],
                ['dog', 'subway'],
                ['apple', 'car'],
                ['banana', 'dog'],
                ['cat', 'subway'],
            ];

            let questions = [];
            let currentQuestionIndex = 0;
            let correctAnswerWord = '';
            let isProcessing = false;

            const speakerIcon = document.getElementById('speaker');
            const card1 = document.getElementById('card1');
            const card2 = document.getElementById('card2');
            const card1Img = card1.querySelector('img');
            const card2Img = card2.querySelector('img');
            const resultMessage = document.getElementById('result-message');
            const questionCounter = document.getElementById('question-counter');
            
            // GitHub 이미지 경로를 생성하는 함수
            function getImagePath(imageName) {
                // 파일을 같은 폴더에서 찾도록 상대 경로로 변경
                return `./${imageName}`;
            }

            // 음성 재생 함수 (TTS 사용)
            function playAudio(word) {
                if ('speechSynthesis' in window) {
                    // 이전 음성 명령 취소
                    window.speechSynthesis.cancel();
                    
                    // 새로운 음성 명령을 매번 생성하여 사용
                    const utterance = new SpeechSynthesisUtterance(word);
                    utterance.lang = 'en-US';
                    utterance.rate = 0.8;
                    
                    const voices = window.speechSynthesis.getVoices();
                    const enVoice = voices.find(voice => voice.lang === 'en-US' && voice.gender === 'female') || voices.find(voice => voice.lang === 'en-US');
                    if (enVoice) {
                        utterance.voice = enVoice;
                    }
                    
                    // 음성 재생
                    window.speechSynthesis.speak(utterance);
                } else {
                    console.error("이 브라우저에서는 텍스트 음성 변환(TTS)을 지원하지 않습니다.");
                }
            }
            
            // 퀴즈 시작 함수
            function startQuiz() {
                questions = shuffle(questionPairs);
                currentQuestionIndex = 0;
                updateUI();
            }

            // 배열 섞기 함수 (Fisher-Yates 알고리즘)
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            // UI 업데이트
            function updateUI() {
                if (currentQuestionIndex >= questions.length) {
                    endGame();
                    return;
                }

                isProcessing = false;
                resultMessage.textContent = '';
                card1.classList.remove('correct-border', 'incorrect-border');
                card2.classList.remove('correct-border', 'incorrect-border');
                
                const currentPair = questions[currentQuestionIndex];
                
                // 정답 단어를 무작위로 선택
                correctAnswerWord = currentPair[Math.floor(Math.random() * currentPair.length)];

                // 카드에 표시할 단어 순서를 섞기
                const cardWords = shuffle([...currentPair]);
                
                // 카드 1 데이터 업데이트
                const card1WordData = words.find(w => w.word === cardWords[0]);
                if (card1WordData) {
                    card1Img.src = getImagePath(card1WordData.image);
                    card1.dataset.word = cardWords[0];
                    card1.setAttribute('alt', cardWords[0]);
                } else {
                    console.error("Card 1 word data not found for:", cardWords[0]);
                }
                
                // 카드 2 데이터 업데이트
                const card2WordData = words.find(w => w.word === cardWords[1]);
                if (card2WordData) {
                    card2Img.src = getImagePath(card2WordData.image);
                    card2.dataset.word = cardWords[1];
                    card2.setAttribute('alt', cardWords[1]);
                } else {
                    console.error("Card 2 word data not found for:", cardWords[1]);
                }

                questionCounter.textContent = `${currentQuestionIndex + 1}/${questions.length}`;
            }

            // 게임 종료 함수
            function endGame() {
                resultMessage.textContent = '게임 완료! 🎉';
                resultMessage.className = 'result-message correct';
                speakerIcon.classList.add('hidden');
                card1.classList.add('hidden');
                card2.classList.add('hidden');
            }

            // 다음 라운드를 시작하는 함수
            function startNextRound() {
                currentQuestionIndex++;
                updateUI();
            }

            // 이벤트 리스너
            speakerIcon.addEventListener('click', () => {
                if (!isProcessing) {
                    playAudio(correctAnswerWord);
                }
            });

            [card1, card2].forEach(card => {
                card.addEventListener('click', () => {
                    if (isProcessing) return;
                    isProcessing = true;

                    const selectedWord = card.dataset.word;
                    if (selectedWord === correctAnswerWord) {
                        resultMessage.textContent = '정답! 😄';
                        resultMessage.className = 'result-message correct';
                        card.classList.add('correct-border');
                    } else {
                        resultMessage.textContent = '다시 해볼까요? 😥';
                        resultMessage.className = 'result-message incorrect';
                        card.classList.add('incorrect-border');
                    }
                    
                    setTimeout(() => {
                        resultMessage.textContent = '';
                        card.classList.remove('incorrect-border');
                        isProcessing = false;
                    }, 1000);

                    if (selectedWord === correctAnswerWord) {
                        setTimeout(startNextRound, 4000); // 4초 후 다음 라운드 시작
                    }
                });
            });

            // 게임 시작
            startQuiz();
        };
    </script>
</body>
</html>
